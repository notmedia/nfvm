#!/usr/bin/env node

'use strict';

const caporal = require('caporal');
const chalk = require('chalk');

const pkg = require('../package.json');
const { Manager } = require('../lib/API');

caporal.version(pkg.version);

caporal.command('init')
  .description('creates .nfvmrc.json config file')
  .action(() => {
    try {
      Manager.initialize();
    } catch (err) {
      console.log(chalk.red(err));
    }
  });

caporal.command('create')
  .argument('<pack>')
  .option('-f, --file')
  .option('-v, --version <version>')
  .option('--folder <path>')
  .option('-g, --global')
  .action((args, options) => {
    try {
      const manager = new Manager(true, options.global);

      if (options.file) {
        manager.createFile(args.pack, options.version);
      } else {
        manager.createPack(args.pack, options.version, options.folder);
      }
    } catch (err) {
      console.log(chalk.red(err));
    }
  });

caporal.command('remove')
  .argument('<pack>')
  .option('-f, --file <name>')
  .option('-v, --version <version>')
  .option('-g, --global')
  .action((args, options) => {

  });

caporal.command('set')
  .argument('<pack>')
  .argument('<version>')
  .option('-g, --global')
  .action((args, options) => {

  });

caporal.command('list')
  .option('-p, --pack <pack>')
  .option('-g, --global')
  .action((args, options) => {
    try {
      const manager = new Manager(true, options.global);

      manager.list(options.pack);
    } catch (err) {
      console.log(chalk.red(err));
    }
  });

caporal.parse(process.argv);
